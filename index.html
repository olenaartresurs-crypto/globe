<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Interactive Globe</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #000;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }
  #globe {
    width: 100vw;
    height: 100vh;
    cursor: grab;
  }
  #globe:active {
    cursor: grabbing;
  }
</style>
</head>

<body>
<div id="globe"></div>

<!-- LIBS -->
<script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
<script src="https://unpkg.com/topojson-client@3"></script>
<script src="https://unpkg.com/three-globe@2"></script>

<script>
const globeEl = document.getElementById("globe");

const world = Globe()
  (globeEl)
  .globeImageUrl("./earth_day_8k.jpg")
  .backgroundColor("#000")
  .atmosphereColor("#6ecfff")
  .atmosphereAltitude(0.25)
  .showAtmosphere(true)
  .polygonsTransitionDuration(200);

const renderer = world.renderer();
renderer.setPixelRatio(window.devicePixelRatio);
renderer.setSize(window.innerWidth, window.innerHeight);

// CAMERA
world.camera().position.z = 320;

// LIGHT
const light = new THREE.DirectionalLight(0xffffff, 1);
light.position.set(5, 3, 5);
world.scene().add(light);

// LOAD COUNTRIES
fetch("./countries-110m.json")
  .then(res => res.json())
  .then(data => {
    const countries = topojson.feature(data, data.objects.countries).features;

    world
      .polygonsData(countries)
      .polygonCapColor(() => "rgba(255,255,255,0.15)")
      .polygonSideColor(() => "rgba(0,150,255,0.15)")
      .polygonStrokeColor(() => "#6ecfff")
      .polygonAltitude(0.01)

      .onPolygonHover(hoverD => {
        world
          .polygonAltitude(d => d === hoverD ? 0.08 : 0.01)
          .polygonCapColor(d => d === hoverD
            ? "rgba(0,180,255,0.8)"
            : "rgba(255,255,255,0.15)"
          );

        globeEl.style.cursor = hoverD ? "pointer" : "grab";
      });
  });

// RESIZE
window.addEventListener("resize", () => {
  world.width(window.innerWidth);
  world.height(window.innerHeight);
});
</script>
</body>
</html>
